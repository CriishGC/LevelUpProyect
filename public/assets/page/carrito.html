<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Carrito | Level-Up Gamer</title>
  <link rel="icon" href="../img/logo.png" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="../CSS/style.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<body>
  <div id="header-placeholder"></div>

    <main class="container carrito-main">
      <div class="row">
        <!-- Listado productos -->
        <div class="col-lg-8 col-md-7">
          <h2 class="carrito-title mb-4-light">Mi carrito de compras</h2>
          <div id="carrito-lista">
            <!-- Los productos agregados se renderizan aquí dinámicamente con JS -->
          </div>
        </div>
        <!-- Resumen carrito -->
        <div class="col-lg-4 col-md-5">
          <div class="carrito-resumen mt-4 mt-md-0">
            <div class="carrito-total">
              <span>TOTAL:</span>
              <span id="total">$ 0</span>
            </div>
            <!-- VALIDACIÓN DUOCUC Y DESCUENTO -->
            <div id="duoc-validacion" class="mt-2"></div>
            <div id="descuento" class="text-success"></div>
            <!-- FIN VALIDACIÓN DUOCUC Y DESCUENTO -->
            <div class="carrito-cupon">
              <input type="text" placeholder="Ingrese el cupón de descuento" id="input-cupon">
              <button id="btn-aplicar-cupon">APLICAR</button>
            </div>
            <button class="carrito-pagar" onclick="checkout()">PAGAR</button>
          </div>
        </div>
      </div>
    </main>

    <div id="footer-placeholder"></div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/assets/js/include.js"></script>
  <script>includeHeaderFooter();</script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>,
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="../js/funciones.js"></script>
  <script src="../js/carrito.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      // Usando las funciones del JS centralizado
      if (typeof cargarCarrito === "function") cargarCarrito();
      if (typeof actualizarBadgeCarrito === "function") actualizarBadgeCarrito();
      if (typeof renderCarrito === "function") renderCarrito();
    });
    document.addEventListener("DOMContentLoaded", function() {
      // Si existe el detalle de producto en la página
      if (typeof renderDetalleProducto === "function") renderDetalleProducto();
      // Actualiza el badge del carrito
      if (typeof actualizarBadgeCarrito === "function") actualizarBadgeCarrito();
    });
  </script>
</body>
</html>