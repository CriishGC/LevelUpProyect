<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Perfil de Usuario | Level-Up Gamer</title>
  <link rel="icon" href="../img/logo.png" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="../CSS/style.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<body>
    <header class="navbar-electric py-3">
        <div class="container d-flex justify-content-between align-items-center">
        <a href="../../index.html" class="d-flex align-items-center text-decoration-none me-3">
            <img src="../img/logo.png" alt="Logo" width="80px" height="80px" class="me-2">
            <span class="fs-4 fw-bold font-orbitron text-white">Level-Up Gamer</span>
        </a>
        <nav class="flex-grow-1">
            <ul class="nav gap-3 justify-content-center">
            <li class="nav-item"><a class="nav-link text-white" href="../../index.html">Inicio</a></li>
            <li class="nav-item"><a class="nav-link text-white" href="catalogo.html">Productos</a></li>
            <li class="nav-item"><a class="nav-link text-white" href="nosotros.html">Nosotros</a></li>
            <li class="nav-item"><a class="nav-link text-white" href="blog.html">Blog</a></li>
            <li class="nav-item"><a class="nav-link text-white" href="contacto.html">Contacto</a></li>
            </ul>
        </nav>
        <!-- Usuario + Carrito arriba a la derecha -->
        <div class="d-flex align-items-center ms-auto gap-3">
            <a href="perfil.html" class="text-white fs-5 d-flex align-items-center" style="text-decoration:none;" title="Perfil de usuario">
                <i class="bi bi-person-circle"></i>
                <span class="ms-1 d-none d-md-inline" id="header-nombre-usuario"></span>
            </a>
            <a href="carrito.html" class="text-white fs-5" style="text-decoration:none;">
                <i class="bi bi-cart"></i>
            </a>
            <span class="text-white ms-2">Carrito (<span id="badge-carrito">0</span>)</span>
        </div>
    </header>

    <main class="container py-5">
      <h1 class="text-center font-orbitron my-4 py-2 text-white">Perfil de Usuario</h1>
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="card bg-dark text-light shadow-lg mb-4">
            <div class="card-body">
              <h5 class="card-title text-neon mb-3">Información del usuario</h5>
              <div class="row mb-2">
                <div class="col-md-6">
                  <p><b>Nombre:</b> <span id="perfil-nombre"></span></p>
                  <p><b>Correo:</b> <span id="perfil-correo"></span></p>
                  <p><b>Fecha de nacimiento:</b> <span id="perfil-nacimiento"></span></p>
                  <p><b>Referido:</b> <span id="perfil-referido"></span></p>
                </div>
                <div class="col-md-6">
                  <p><b>Nivel:</b> <span id="perfil-nivel"></span></p>
                  <p><b>Puntos:</b> <span id="perfil-puntos"></span></p>
                  <p><b>¿Es DuocUC?:</b> <span id="perfil-duoc"></span></p>
                  <p><b>Descuento DuocUC:</b> <span id="perfil-duoc-descuento" class="fw-bold text-success"></span></p>
                </div>
              </div>
            </div>
          </div>

          <div class="card bg-secondary text-light shadow mb-4">
            <div class="card-body">
              <h5 class="card-title mb-3">Carrito de compras (demo)</h5>
              <div id="carrito-lista"></div>
              <div class="mt-4">
                <div class="carrito-total">
                  <span>TOTAL:</span>
                  <span id="total">$ 0</span>
                </div>
                <div id="descuento" class="text-success"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer class="bg-dark border-top border-secondary py-3 mt-5 text-white">
        <div class="container d-flex flex-wrap justify-content-between align-items-center">
        <div>
            <span class="fw-bold font-orbitron fs-5 text-neon">Level-Up Gamer</span>
            <div class="mt-3">
            <img src="../img/visa.png" width="32" alt="Visa" class="me-2">
            <img src="../img/mastercard.png" width="32" alt="Mastercard" class="me-2">
            <img src="../img/paypal.png" width="32" alt="Paypal">
            </div>
        </div>
        <div class="d-flex flex-column align-items-end">
            <a 
            href="https://wa.me/56984977053" 
            target="_blank" 
            rel="noopener" 
            class="btn btn-success btn-whatsapp-footer d-flex align-items-center mb-2"
            style="background-color:#39FF14;border-color:#39FF14;color:#000;font-weight:bold;">
            <i class="bi bi-whatsapp me-2 fs-5"></i> Soporte Técnico (WhatsApp)
            </a>
            <span class="text-secondary small">¿Dudas o problemas? ¡Contáctanos!</span>
        </div>
        </div>
        <div class="text-center mt-3 text-secondary"><small>© 2025 Level-Up Gamer — Despachos a todo Chile</small></div>
    </footer>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Demo usuario DuocUC
    const estado = {
      usuario: {
        nombre: "Juan Pérez",
        correo: "juan.perez@gmail.com",
        nacimiento: "1999-04-20",
        referido: "Instagram",
        esDuoc: false,
        puntos: 150,
        nivel: "Plata"
      },
      carrito: [
        {cod:"JM001", nombre:"Catan", precio:29990, qty:1},
        {cod:"AC002", nombre:"Auriculares HyperX Cloud II", precio:79990, qty:2}
      ]
    };
    // Utilidad para formato CLP
    function formateaCLP(n){ return n.toLocaleString("es-CL")+" CLP"; }

    // Render perfil en pantalla
    function renderPerfilUsuario() {
      document.getElementById("perfil-nombre").textContent = estado.usuario.nombre;
      document.getElementById("perfil-correo").textContent = estado.usuario.correo;
      document.getElementById("perfil-nacimiento").textContent = estado.usuario.nacimiento;
      document.getElementById("perfil-referido").textContent = estado.usuario.referido || "-";
      document.getElementById("perfil-nivel").textContent = estado.usuario.nivel;
      document.getElementById("perfil-puntos").textContent = estado.usuario.puntos;
      document.getElementById("perfil-duoc").textContent = estado.usuario.correo.endsWith("@duocuc.cl") ? "Sí" : "No";
      document.getElementById("perfil-duoc-descuento").textContent =
        estado.usuario.correo.endsWith("@duocuc.cl") ? "Sí, 20%" : "No";
      // También nombre en header si existe
      const headerNombre = document.getElementById("header-nombre-usuario");
      if (headerNombre) headerNombre.textContent = estado.usuario.nombre;
    }

    // Render carrito demo
    function renderCarrito() {
      const list = document.getElementById("carrito-lista");
      if(!list) return;
      if(estado.carrito.length === 0){
        list.innerHTML = `<div class="list-group-item bg-dark text-light">Tu carrito está vacío.</div>`;
        if (document.getElementById("total")) document.getElementById("total").textContent = "$ 0";
      } else {
        list.innerHTML = estado.carrito.map((it, idx) => `
          <div class="list-group-item bg-dark text-light d-flex justify-content-between align-items-center mb-2">
            <div>
              <strong>${it.nombre}</strong><br>
              <small>${formateaCLP(it.precio)} c/u</small>
            </div>
            <div class="d-flex align-items-center gap-2">
              <span>${it.qty} unidad${it.qty > 1 ? "es" : ""}</span>
              <span class="fw-bold">${formateaCLP(it.precio * it.qty)}</span>
            </div>
          </div>
        `).join("");
        actualizarTotales();
      }
    }

    // Calcula y muestra total con descuento DuocUC si aplica
    function actualizarTotales() {
      const subtotal = estado.carrito.reduce((a, i) => a + i.precio * i.qty, 0);
      let descuento = 0;
      if (
        estado.usuario.correo &&
        estado.usuario.correo.trim().toLowerCase().endsWith("@duocuc.cl")
      ) {
        descuento = subtotal * 0.20;
        document.getElementById("descuento").innerHTML =
          `<span>Descuento DuocUC: -${formateaCLP(descuento)} (20%)</span>`;
      } else {
        document.getElementById("descuento").innerHTML = "";
      }
      const totalFinal = subtotal - descuento;
      if (document.getElementById("total"))
        document.getElementById("total").textContent = formateaCLP(totalFinal);
    }

    document.addEventListener("DOMContentLoaded", function() {
      renderPerfilUsuario();
      renderCarrito();
    });
  </script>
</body>
</html>